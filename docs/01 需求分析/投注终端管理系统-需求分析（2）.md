# 投注终端管理系统-需求分析（2）

## 1.引言

### 1.1编写目的

为将《试用期任务书》（下简称《书》）中关于《投注终端管理系统》（下简称《系统》）的各项需求真正细化，理清功能模块和开发逻辑，现结合已有PHP版《系统》功能，编写本说明。

### 1.2参考文档

1. 《试用期任务书》

## 2.任务概述

### 2.1项目现状

项目目前处于需求确认阶段，参考已有PHP版《管理系统》开发了预览版的单体应用系统，基本覆盖PHP版各功能点，可更直观的明确需求。

但考虑到《任务书》中所述需求较为粗略笼统，缺乏实际生产环境信息，而PHP版也未实际运用于生产，且功能与《任务书》中需求略有出入，并不能作为最终输出成果。

整个项目需求尚需进一步确认。

### 2.2项目目标

项目提供基于HTTP  API的接口，对设备从注册、分组、认证、软件升级、状态上报到注销的全生命周期管理。接口按照使用对象可分为管理接口和设备接入接口。

管理接口：主要供管理人员在后台对设备进行统一管理。

设备接入接口：主要供设备与系统进行交互，更新设备状态和日志信息。

## 3.系统需求分析

### 3.1系统体系结构图

![结构图](E:\Projects\tzzd\docs\01 需求分析\系统架构（1）.png)

### 3.2技术选型

**后端框架： Springboot2.0+Mybatis**

**数据库：MySQL**

**前端框架：**集成**Swagger-UI**自动生成接口页面

**分布式框架：dubbo**

### 3.3容器化管理

考虑到分布式系统的灵活管理和低环境依赖性，建议采用docker容器对系统相关服务进行自动化部署。

考虑到业务相对简单，服务压力不大，不需要太大规模的集群，同时也为了未来的持续集成，考虑使用docker-compose对容器进行编排。

容器依赖关系图待补。。。

### 3.4系统总体流程图

待补。。。

## 4.功能性需求

#### 4.1设备管理

1.设备注册：支持设备提交完整信息注册为新设备。只有注册的设备才能进行其他设备相关操作

2.设备信息：通过列表的形式展示注册设备信息、在线/下线状态，同时提供注册设备的增、删改。

#### 4.2设备分组

1.分组信息：通过列表的形式展示注册设备分组信息，同时提供注设备分组的增、删改。所有未指定分组的设备默认加入“默认”分组。

2.修改设备分组：调整设备的分组。

#### 4.3设备软件版本管理

1.软件上传下载：支持软件上传、下载和列表查看，附件保存到应用所在容器的指定路径下，未来可拓展为专用的FTP或其他分布式文件服务器。

2.软件版本控制：指定不同类型软件的版本和对应文件，供设备查询最新版本信息，与服务器保持同步。

#### 4.4设备日志管理

默认了注册、删除、修改、登入、登入、登出、报错等6类日志类别，支持对设备日志列表的模糊或分类查询。

#### 4.5设备接入

设备认证：设备通过提交ID、串号和编码，与数据库中注册设备信息进行比对，识别相应设备，此功能未来可拓展为设备鉴权相关模块，通过数据加密和JWT的方式授予设备相应系统权限。

#### 4.6状态上报

正常情况下，设备需在指定时间（默认10s）内定期向服务器发送状态信息，信息类型包括：登入、登出和异常。登入设备会将状态加入Redis；登出设备会删除Redis相应记录，同时将登出时间记录到数据库中;异常信息会记入设备日志。

#### 4.7升级软件下载

设备通过访问软件信息接口，获取最新软件版本的JSON对象，通过比对版本号，下载更新版本号不一致的软件。

必要时，提供版本分级，如：必要升级（不升级暂不提供服务），重要升级（限制时间内升级），常规升级（可不升级）

## 5.非功能性需求

### 5.1用户界面需求

无

### 5.2系统性能需求

无

### 5.3系统其它需求

为了实现系统功能，还需要提供附件管理和数据字典服务。

1.附件管理：提供附件的上传、下载和删除，对应到业务功能，提供了设备软件的维护。

2.数据字典：实现部分数据的可配置，入设备状态分类、软件分类、日志分类等。目前数据字典暂不提供CURD接口。后续对于一些不影响业务逻辑的配置可以单独开发接口对数据字典相应类型进行维护。


